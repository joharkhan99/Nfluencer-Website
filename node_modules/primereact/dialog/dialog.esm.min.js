import*as e from"react";import t,{localeOption as n}from"primereact/api";import{CSSTransition as r}from"primereact/csstransition";import{useEventListener as o,useMountEffect as i,useUpdateEffect as a,useUnmountEffect as l}from"primereact/hooks";import{TimesIcon as c}from"primereact/icons/times";import{WindowMaximizeIcon as u}from"primereact/icons/windowmaximize";import{WindowMinimizeIcon as s}from"primereact/icons/windowminimize";import{Portal as m}from"primereact/portal";import{Ripple as d}from"primereact/ripple";import{UniqueComponentId as p,DomHandler as f,ZIndexUtils as g,classNames as b,mergeProps as y,ObjectUtils as h,IconUtils as v}from"primereact/utils";import{ComponentBase as w}from"primereact/componentbase";function S(e){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},S(e)}function E(e,t){if("object"!==S(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==S(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function x(e){var t=E(e,"string");return"symbol"===S(t)?t:String(t)}function z(e,t,n){return(t=x(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function O(e){if(Array.isArray(e))return k(e)}function C(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function D(e,t){if(e){if("string"==typeof e)return k(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?k(e,t):void 0}}function I(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function P(e){if(Array.isArray(e))return e}function R(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function N(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function j(e,t){return P(e)||R(e,t)||D(e,t)||N()}var M=w.extend({defaultProps:{__TYPE:"Dialog",appendTo:null,ariaCloseIconLabel:null,baseZIndex:0,blockScroll:!1,breakpoints:null,className:null,closable:!0,closeIcon:null,closeOnEscape:!0,contentClassName:null,contentStyle:null,dismissableMask:!1,draggable:!0,focusOnShow:!0,footer:null,header:null,headerClassName:null,headerStyle:null,icons:null,id:null,keepInViewport:!0,maskClassName:null,maskStyle:null,maximizable:!1,maximizeIcon:null,maximized:!1,minX:0,minY:0,minimizeIcon:null,modal:!0,onClick:null,onDrag:null,onDragEnd:null,onDragStart:null,onHide:null,onMaskClick:null,onMaximize:null,onResize:null,onResizeEnd:null,onResizeStart:null,onShow:null,position:"center",resizable:!0,rtl:!1,showHeader:!0,style:null,transitionOptions:null,visible:!1,children:void 0}});function X(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function H(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?X(Object(n),!0).forEach((function(t){z(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):X(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var T=e.forwardRef((function(w,S){var E=M.getProps(w),x=E.id?E.id:p(),z=j(e.useState(x),2),k=z[0],P=j(e.useState(!1),2),R=P[0],N=P[1],X=j(e.useState(!1),2),T=X[0],A=X[1],Y=j(e.useState(E.maximized),2),B=Y[0],V=Y[1],_=e.useRef(null),J=e.useRef(null),L=e.useRef(null),W=e.useRef(null),Z=e.useRef(null),F=e.useRef(null),U=e.useRef(null),$=e.useRef(!1),K=e.useRef(!1),q=e.useRef(null),G=e.useRef(null),Q=e.useRef(null),ee=e.useRef(x),te=E.onMaximize?E.maximized:B,ne=M.setMetaData({props:E,state:{id:k,maximized:te,containerVisible:R}}).ptm,re=j(o({type:"keydown",listener:function(e){return Ee(e)}}),2),oe=re[0],ie=re[1],ae=j(o({type:"mousemove",target:function(){return window.document},listener:function(e){return De(e)}}),2),le=ae[0],ce=ae[1],ue=j(o({type:"mouseup",target:function(){return window.document},listener:function(e){return Ie(e)}}),2),se=ue[0],me=ue[1],de=j(o({type:"mousemove",target:function(){return window.document},listener:function(e){return ze(e)}}),2),pe=de[0],fe=de[1],ge=j(o({type:"mouseup",target:function(){return window.document},listener:function(e){return ke(e)}}),2),be=ge[0],ye=ge[1],he=function(e){E.onHide(),e.preventDefault()},ve=function(e){L.current=e.target,E.onPointerDown&&E.onPointerDown(e)},we=function(e){E.dismissableMask&&E.modal&&J.current===e.target&&!L.current&&he(e),E.onMaskClick&&E.onMaskClick(e),L.current=null},Se=function(e){E.onMaximize?E.onMaximize({originalEvent:e,maximized:!te}):V((function(e){return!e})),e.preventDefault()},Ee=function(e){var t=e.currentTarget;if(t&&t.primeDialogParams){var n=t.primeDialogParams,r=n.length,o=n[r-1]?n[r-1].id:void 0;if(o===k){var i=document.getElementById(o);if(E.closable&&E.closeOnEscape&&"Escape"===e.key)he(e),e.stopImmediatePropagation(),n.splice(r-1,1);else if("Tab"===e.key){e.preventDefault();var a=f.getFocusableElements(i);if(a&&a.length>0)if(document.activeElement){var l=a.indexOf(document.activeElement);e.shiftKey?-1===l||0===l?a[a.length-1].focus():a[l-1].focus():-1===l||l===a.length-1?a[0].focus():a[l+1].focus()}else a[0].focus()}}}},xe=function(e){f.hasClass(e.target,"p-dialog-header-icon")||f.hasClass(e.target.parentElement,"p-dialog-header-icon")||E.draggable&&($.current=!0,q.current=e.pageX,G.current=e.pageY,_.current.style.margin="0",f.addClass(document.body,"p-unselectable-text"),E.onDragStart&&E.onDragStart(e))},ze=function(e){if($.current){var t=f.getOuterWidth(_.current),n=f.getOuterHeight(_.current),r=e.pageX-q.current,o=e.pageY-G.current,i=_.current.getBoundingClientRect(),a=i.left+r,l=i.top+o,c=f.getViewport();_.current.style.position="fixed",E.keepInViewport?(a>=E.minX&&a+t<c.width&&(q.current=e.pageX,_.current.style.left=a+"px"),l>=E.minY&&l+n<c.height&&(G.current=e.pageY,_.current.style.top=l+"px")):(q.current=e.pageX,_.current.style.left=a+"px",G.current=e.pageY,_.current.style.top=l+"px"),E.onDrag&&E.onDrag(e)}},ke=function(e){$.current&&($.current=!1,f.removeClass(document.body,"p-unselectable-text"),E.onDragEnd&&E.onDragEnd(e))},Oe=function(e){E.resizable&&(K.current=!0,q.current=e.pageX,G.current=e.pageY,f.addClass(document.body,"p-unselectable-text"),E.onResizeStart&&E.onResizeStart(e))},Ce=function(e,t,n){!n&&(n=f.getViewport());var r=parseInt(e);return/^(\d+|(\.\d+))(\.\d+)?%$/.test(e)?r*(n[t]/100):r},De=function(e){if(K.current){var t=e.pageX-q.current,n=e.pageY-G.current,r=f.getOuterWidth(_.current),o=f.getOuterHeight(_.current),i=_.current.getBoundingClientRect(),a=f.getViewport(),l=!parseInt(_.current.style.top)||!parseInt(_.current.style.left),c=Ce(_.current.style.minWidth,"width",a),u=Ce(_.current.style.minHeight,"height",a),s=r+t,m=o+n;l&&(s+=t,m+=n),(!c||s>c)&&i.left+s<a.width&&(_.current.style.width=s+"px"),(!u||m>u)&&i.top+m<a.height&&(_.current.style.height=m+"px"),q.current=e.pageX,G.current=e.pageY,E.onResize&&E.onResize(e)}},Ie=function(e){K.current&&(K.current=!1,f.removeClass(document.body,"p-unselectable-text"),E.onResizeEnd&&E.onResizeEnd(e))},Pe=function(){_.current.style.position="",_.current.style.left="",_.current.style.top="",_.current.style.margin=""},Re=function(){_.current.setAttribute(ee.current,"")},Ne=function(){var e;E.onShow&&E.onShow(),E.focusOnShow&&!((e=document.activeElement)&&_.current&&_.current.contains(e))&&E.closable&&E.showHeader&&U.current.focus(),Xe()},je=function(){E.modal&&f.addClass(J.current,"p-component-overlay-leave"),E.blockScroll&&f.removeClass(document.body,"p-overflow-hidden")},Me=function(){$.current=!1,g.clear(J.current),N(!1),He()},Xe=function(){Te(),(E.blockScroll||E.maximizable&&te)&&f.addClass(document.body,"p-overflow-hidden")},He=function(){Ae();var e=E.maximizable&&te;E.modal?(document.primeDialogParams&&document.primeDialogParams.some((function(e){return e.hasBlockScroll}))||e)&&f.removeClass(document.body,"p-overflow-hidden"):(E.blockScroll||e)&&f.removeClass(document.body,"p-overflow-hidden")},Te=function(){E.draggable&&(pe(),be()),E.resizable&&(le(),se()),oe();var e,t={id:k,hasBlockScroll:E.blockScroll};document.primeDialogParams=document.primeDialogParams?[].concat(O(e=document.primeDialogParams)||C(e)||D(e)||I(),[t]):[t]},Ae=function(){fe(),ye(),ce(),me(),ie(),document.primeDialogParams=document.primeDialogParams&&document.primeDialogParams.filter((function(e){return e.id!==k}))},Ye=function(){Q.current=f.createInlineStyle(t.nonce);var e="";for(var n in E.breakpoints)e+="\n                @media screen and (max-width: ".concat(n,") {\n                    .p-dialog[").concat(ee.current,"] {\n                        width: ").concat(E.breakpoints[n]," !important;\n                    }\n                }\n            ");Q.current.innerHTML=e};i((function(){E.visible&&N(!0),E.breakpoints&&Ye()})),a((function(){E.visible&&!R&&N(!0),E.visible!==T&&R&&A(E.visible)})),a((function(){R&&(g.set("modal",J.current,t.autoZIndex,E.baseZIndex||t.zIndex.modal),A(!0))}),[R]),a((function(){E.blockScroll||f[te&&T?"addClass":"removeClass"](document.body,"p-overflow-hidden")}),[E.maximized,B,T]),l((function(){He(),f.removeInlineStyle(Q.current),g.clear(J.current)})),e.useImperativeHandle(S,(function(){return{props:E,resetPosition:Pe,getElement:function(){return _.current},getMask:function(){return J.current},getContent:function(){return W.current},getHeader:function(){return Z.current},getFooter:function(){return F.current},getCloseButton:function(){return U.current}}}));var Be,Ve,_e,Je,Le,We,Ze,Fe,Ue,$e,Ke,qe,Ge=function(){if(E.closable){var t=E.ariaCloseIconLabel||n("close"),r=y({className:"p-dialog-header-close-icon","aria-hidden":!0},ne("closeButtonIcon")),o=v.getJSXIcon(E.closeIcon||e.createElement(c,r),H({},r),{props:E}),i=y({ref:U,type:"button",className:"p-dialog-header-icon p-dialog-header-close p-link","aria-label":t,onClick:he},ne("closeButton"));return e.createElement("button",i,o,e.createElement(d,null))}return null},Qe=function(){var t=y({className:"p-dialog-header-maximize-icon"},ne("maximizableIcon")),n=v.getJSXIcon(te?E.minimizeIcon||e.createElement(s,t):E.maximizeIcon||e.createElement(u,t),t,{props:E});if(E.maximizable){var r=y({type:"button",className:"p-dialog-header-icon p-dialog-header-maximize p-link",onClick:Se},ne("maximizableButton"));return e.createElement("button",r,n,e.createElement(d,null))}return null},et=function(){if(E.showHeader){var t=Ge(),n=Qe(),r=h.getJSXElement(E.icons,E),o=h.getJSXElement(E.header,E),i=k+"_header",a=b("p-dialog-header",E.headerClassName),l=y({ref:Z,style:E.headerStyle,className:a,onMouseDown:xe},ne("header")),c=y({id:i,className:"p-dialog-title"},ne("headerTitle")),u=y({className:"p-dialog-header-icons"},ne("headerIcons"));return e.createElement("div",l,e.createElement("div",c,o),e.createElement("div",u,r,n,t))}return null},tt=function(){var t=b("p-dialog-content",E.contentClassName),n=y({id:k+"_content",ref:W,style:E.contentStyle,className:t},ne("content"));return e.createElement("div",n,E.children)},nt=function(){var t=h.getJSXElement(E.footer,E),n=y({ref:F,className:"p-dialog-footer"},ne("footer"));return t&&e.createElement("div",n,t)};return R&&(Ve=b("p-dialog p-component",E.className,{"p-dialog-rtl":E.rtl,"p-dialog-maximized":te,"p-dialog-default":!te,"p-input-filled":"filled"===t.inputStyle,"p-ripple-disabled":!1===t.ripple}),_e=b("p-dialog-mask",(Be=["center","left","right","top","top-left","top-right","bottom","bottom-left","bottom-right"].find((function(e){return e===E.position||e.replace("-","")===E.position})))?"p-dialog-".concat(Be):"",{"p-component-overlay p-component-overlay-enter":E.modal,"p-dialog-visible":R,"p-dialog-draggable":E.draggable,"p-dialog-resizable":E.resizable},E.maskClassName),Je=et(),Le=tt(),We=nt(),Ze=E.resizable?e.createElement("span",{className:"p-resizable-handle",style:{zIndex:90},onMouseDown:Oe}):null,Fe=k+"_header",Ue=k+"_content",$e={enter:"center"===E.position?150:300,exit:"center"===E.position?150:300},Ke=y({ref:J,style:E.maskStyle,className:_e,onPointerUp:we},ne("mask")),qe=y({ref:_,id:k,className:Ve,style:E.style,onClick:E.onClick,role:"dialog","aria-labelledby":Fe,"aria-describedby":Ue,"aria-modal":E.modal,onPointerDown:ve},M.getOtherProps(E),ne("root")),e.createElement(m,{element:e.createElement("div",Ke,e.createElement(r,{nodeRef:_,classNames:"p-dialog",timeout:$e,in:T,options:E.transitionOptions,unmountOnExit:!0,onEnter:Re,onEntered:Ne,onExiting:je,onExited:Me},e.createElement("div",qe,Je,Le,We,Ze))),appendTo:E.appendTo,visible:!0}))}));T.displayName="Dialog";export{T as Dialog};
