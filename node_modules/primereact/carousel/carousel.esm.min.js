import*as e from"react";import t,{ariaLabel as r}from"primereact/api";import{usePrevious as n,useResizeListener as a,useMountEffect as l,useUpdateEffect as o,useUnmountEffect as c}from"primereact/hooks";import{ChevronDownIcon as u}from"primereact/icons/chevrondown";import{ChevronLeftIcon as i}from"primereact/icons/chevronleft";import{ChevronRightIcon as s}from"primereact/icons/chevronright";import{ChevronUpIcon as m}from"primereact/icons/chevronup";import{Ripple as p}from"primereact/ripple";import{ObjectUtils as f,classNames as v,UniqueComponentId as d,DomHandler as h,IconUtils as g}from"primereact/utils";function b(){return b=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},b.apply(this,arguments)}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function N(e){if(Array.isArray(e))return y(e)}function E(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function I(e,t){if(e){if("string"==typeof e)return y(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?y(e,t):void 0}}function S(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function C(e){if(Array.isArray(e))return e}function w(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,l,o,c=[],u=!0,i=!1;try{if(l=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=l.call(r)).done)&&(c.push(n.value),c.length!==t);u=!0);}catch(e){i=!0,a=e}finally{try{if(!u&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(i)throw a}}return c}}function P(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function k(e,t){return C(e)||w(e,t)||I(e,t)||P()}var x={defaultProps:{__TYPE:"Carousel",id:null,value:null,page:0,header:null,footer:null,style:null,className:null,itemTemplate:null,circular:!1,showIndicators:!0,showNavigators:!0,autoplayInterval:0,numVisible:1,numScroll:1,prevIcon:null,nextIcon:null,responsiveOptions:null,orientation:"horizontal",verticalViewPortHeight:"300px",contentClassName:null,containerClassName:null,indicatorsContentClassName:null,onPageChange:null,children:void 0},getProps:function(e){return f.getMergedProps(e,x.defaultProps)},getOtherProps:function(e){return f.getDiffProps(e,x.defaultProps)}},O=e.memo((function(t){var r=t.template(t.item),n=v(t.className,"p-carousel-item",{"p-carousel-item-active":t.active,"p-carousel-item-start":t.start,"p-carousel-item-end":t.end});return e.createElement("div",{className:n},r)})),T=e.memo(e.forwardRef((function(y,C){var w=x.getProps(y),P=k(e.useState(w.numVisible),2),T=P[0],R=P[1],A=k(e.useState(w.numScroll),2),M=A[0],V=A[1],j=k(e.useState(w.page*w.numScroll*-1),2),D=j[0],H=j[1],L=k(e.useState(w.page),2),X=L[0],_=L[1],Y=e.useRef(null),z=e.useRef(null),J=e.useRef(0),F=e.useRef(!!w.autoplayInterval),U=e.useRef(""),W=e.useRef(20),$=e.useRef(null),q=e.useRef(null),B=e.useRef(null),G=e.useRef(!1),K=e.useRef(null),Q=n(M),Z=n(T),ee=n(w.value),te=n(w.page),re="vertical"===w.orientation,ne=w.circular||!!w.autoplayInterval,ae=ne&&w.value&&w.value.length>=T,le=w.value?Math.max(Math.ceil((w.value.length-T)/M)+1,0):0,oe=le&&w.autoplayInterval&&F.current,ce=w.onPageChange&&!oe,ue=ce?w.page:X,ie=k(a({listener:function(){me()},when:w.responsiveOptions}),1)[0],se=function(e,t){var r=D;null!=t?(r=M*t*-1,ae&&(r-=T),G.current=!1):(r+=M*e,G.current&&(r+=J.current-M*e,G.current=!1),t=Math.abs(Math.floor((ae?r+T:r)/M)));ae&&X===le-1&&-1===e?(r=-1*(w.value.length+T),t=0):ae&&0===X&&1===e?(r=0,t=le-1):t===le-1&&J.current>0&&(r+=-1*J.current-M*e,G.current=!0),z.current&&(h.removeClass(z.current,"p-items-hidden"),Ie(r),z.current.style.transition="transform 500ms ease 0s"),Se(t),H(r)},me=function(){if(z.current&&K.current){for(var e=window.innerWidth,t={numVisible:w.numVisible,numScroll:w.numScroll},r=0;r<K.current.length;r++){var n=K.current[r];parseInt(n.breakpoint,10)>=e&&(t=n)}if(M!==t.numScroll){var a=Math.floor(ue*M/t.numScroll),l=t.numScroll*a*-1;ae&&(l-=t.numVisible),H(l),V(t.numScroll),Se(a)}T!==t.numVisible&&R(t.numVisible)}},pe=function(e,t){(ne||0!==ue)&&se(1,t),F.current=!1,e.cancelable&&e.preventDefault()},fe=function(e,t){(ne||ue<le-1)&&se(-1,t),F.current=!1,e.cancelable&&e.preventDefault()},ve=function(e,t){t>ue?fe(e,t):t<ue&&pe(e,t)},de=function(e){z.current&&"transform"===e.propertyName&&(h.addClass(z.current,"p-items-hidden"),z.current.style.transition="",0!==X&&X!==le-1||!ae||Ie(D))},he=function(e){var t=e.changedTouches[0];$.current={x:t.pageX,y:t.pageY}},ge=function(e){e.cancelable&&e.preventDefault()},be=function(e){var t=e.changedTouches[0];ye(e,re?t.pageY-$.current.y:t.pageX-$.current.x)},ye=function(e,t){Math.abs(t)>W&&(t<0?fe(e):pe(e))},Ne=function(){q.current&&clearInterval(q.current)},Ee=function(){B.current||(B.current=h.createInlineStyle(t.nonce));var e,r="\n            .p-carousel[".concat(U.current,"] .p-carousel-item {\n                flex: 1 0 ").concat(100/T,"%\n            }\n        ");if(w.responsiveOptions){K.current=N(e=w.responsiveOptions)||E(e)||I(e)||S(),K.current.sort((function(e,r){return f.sort(e.breakpoint,r.breakpoint,-1,t.locale,t.nullSortOrder)}));for(var n=0;n<K.current.length;n++){var a=K.current[n];r+="\n                    @media screen and (max-width: ".concat(a.breakpoint,") {\n                        .p-carousel[").concat(U.current,"] .p-carousel-item {\n                            flex: 1 0 ").concat(100/a.numVisible,"%\n                        }\n                    }\n                ")}}B.current.innerHTML=r},Ie=function(e){z.current&&(z.current.style.transform=re?"translate3d(0, ".concat(e*(100/T),"%, 0)"):"translate3d(".concat(e*(100/T),"%, 0, 0)"))},Se=function(e){!ce&&_(e),w.onPageChange&&w.onPageChange({page:e})};e.useImperativeHandle(C,(function(){return{props:w,getElement:function(){return Y.current}}})),l((function(){Y.current&&(U.current=d(),Y.current.setAttribute(U.current,"")),Ee(),me(),Ie(D),ie()})),o((function(){var e=!1,t=D;if(w.autoplayInterval&&Ne(),Q!==M||Z!==T||w.value&&ee&&ee.length!==w.value.length){J.current=(w.value.length-T)%M;var r=ue;0!==le&&r>=le&&(Se(r=le-1),e=!0),t=r*M*-1,ae&&(t-=T),r===le-1&&J.current>0?(t+=-1*J.current+M,G.current=!0):G.current=!1,t!==D&&(H(t),e=!0),Ie(t)}ae&&(0===X?t=-1*T:0===t&&(t=-1*w.value.length,J.current>0&&(G.current=!0)),t!==D&&(H(t),e=!0)),te!==w.page&&(w.page>te&&w.page<=le-1?se(-1,w.page):w.page<te&&se(1,w.page)),!e&&oe&&(q.current=setInterval((function(){se(-1,X===le-1?0:X+1)}),w.autoplayInterval))})),c((function(){w.autoplayInterval&&Ne()}));var Ce=function(){if(w.value&&w.value.length){var t=null,r=null;if(ae){var n=null;t=(n=w.value.slice(-1*T)).map((function(t,r){return e.createElement(O,{key:r+"_scloned",className:"p-carousel-item-cloned",template:w.itemTemplate,item:t,active:-1*D===w.value.length+T,start:0===r,end:r===n.length-1})})),r=(n=w.value.slice(0,T)).map((function(t,r){return e.createElement(O,{key:r+"_fcloned",className:"p-carousel-item-cloned",template:w.itemTemplate,item:t,active:0===D,start:0===r,end:r===n.length-1})}))}var a=w.value.map((function(t,r){var n=ae?-1*(D+T):-1*D,a=n+T-1;return e.createElement(O,{key:r,template:w.itemTemplate,item:t,active:n<=r&&a>=r,start:n===r,end:a===r})}));return e.createElement(e.Fragment,null,t,a,r)}},we=function(){if(w.showNavigators){var t=(!ne||w.value&&w.value.length<T)&&0===ue,n=v("p-carousel-prev p-link",{"p-disabled":t}),a="p-carousel-prev-icon",l=g.getJSXIcon(re?w.prevIcon||e.createElement(m,{className:a}):w.prevIcon||e.createElement(i,{className:a}),{className:n},{props:w});return e.createElement("button",{type:"button",className:n,onClick:pe,disabled:t,"aria-label":r("previousPageLabel")},l,e.createElement(p,null))}return null},Pe=function(){if(w.showNavigators){var t=(!ne||w.value&&w.value.length<T)&&(ue===le-1||0===le),n=v("p-carousel-next p-link",{"p-disabled":t}),a="p-carousel-next-icon",l=g.getJSXIcon(re?w.nextIcon||e.createElement(u,{className:a}):w.nextIcon||e.createElement(s,{className:a}),{className:n},{props:w});return e.createElement("button",{type:"button",className:n,onClick:fe,disabled:t,"aria-label":r("nextPageLabel")},l,e.createElement(p,null))}return null},ke=function(t){var n="carousel-indicator-"+t,a=v("p-carousel-indicator",{"p-highlight":ue===t});return e.createElement("li",{key:n,className:a},e.createElement("button",{type:"button",className:"p-link",onClick:function(e){return ve(e,t)},"aria-label":"".concat(r("pageLabel")," ").concat(t+1)},e.createElement(p,null)))},xe=x.getOtherProps(w),Oe=v("p-carousel p-component",{"p-carousel-vertical":re,"p-carousel-horizontal":!re},w.className),Te=v("p-carousel-content",w.contentClassName),Re=function(){var t=Ce(),r=re?w.verticalViewPortHeight:"auto",n=we(),a=Pe(),l=v("p-carousel-container",w.containerClassName);return e.createElement("div",{className:l},n,e.createElement("div",{className:"p-carousel-items-content",style:{height:r},onTouchStart:he,onTouchMove:ge,onTouchEnd:be},e.createElement("div",{ref:z,className:"p-carousel-items-container",onTransitionEnd:de},t)),a)}(),Ae=function(){if(w.showIndicators){for(var t=v("p-carousel-indicators p-reset",w.indicatorsContentClassName),r=[],n=0;n<le;n++)r.push(ke(n));return e.createElement("ul",{className:t},r)}return null}(),Me=w.header?e.createElement("div",{className:"p-carousel-header"},w.header):null,Ve=w.footer?e.createElement("div",{className:"p-carousel-footer"},w.footer):null;return e.createElement("div",b({ref:Y,id:w.id,className:Oe,style:w.style},xe),Me,e.createElement("div",{className:Te},Re,Ae),Ve)})));O.displayName="CarouselItem",T.displayName="Carousel";export{T as Carousel};
