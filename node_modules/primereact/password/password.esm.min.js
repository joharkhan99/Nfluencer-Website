import*as e from"react";import t,{localeOption as n}from"primereact/api";import{CSSTransition as r}from"primereact/csstransition";import{useOverlayListener as o,useUnmountEffect as l}from"primereact/hooks";import{InputText as a}from"primereact/inputtext";import{OverlayService as u}from"primereact/overlayservice";import{Portal as i}from"primereact/portal";import{ObjectUtils as s,DomHandler as p,ZIndexUtils as c,classNames as f,IconUtils as m}from"primereact/utils";import{EyeIcon as d}from"primereact/icons/eye";import{EyeSlashIcon as g}from"primereact/icons/eyeslash";function y(){return y=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},y.apply(this,arguments)}function h(e){if(Array.isArray(e))return e}function w(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,l,a,u=[],i=!0,s=!1;try{if(l=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;i=!1}else for(;!(i=(r=l.call(n)).done)&&(u.push(r.value),u.length!==t);i=!0);}catch(e){s=!0,o=e}finally{try{if(!i&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return u}}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function E(e,t){if(e){if("string"==typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?v(e,t):void 0}}function b(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function k(e,t){return h(e)||w(e,t)||E(e,t)||b()}var R={defaultProps:{__TYPE:"Password",id:null,inputId:null,inputRef:null,promptLabel:null,weakLabel:null,mediumLabel:null,strongLabel:null,mediumRegex:"^(((?=.*[a-z])(?=.*[A-Z]))|((?=.*[a-z])(?=.*[0-9]))|((?=.*[A-Z])(?=.*[0-9])))(?=.{6,})",strongRegex:"^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.{8,})",feedback:!0,toggleMask:!1,appendTo:null,header:null,content:null,footer:null,showIcon:null,hideIcon:null,icon:null,tooltip:null,tooltipOptions:null,style:null,className:null,inputStyle:null,inputClassName:null,panelStyle:null,panelClassName:null,transitionOptions:null,onInput:null,onShow:null,onHide:null,children:void 0},getProps:function(e){return s.getMergedProps(e,R.defaultProps)},getOtherProps:function(e){return s.getDiffProps(e,R.defaultProps)}},S=e.memo(e.forwardRef((function(h,w){var v=R.getProps(h),E=v.promptLabel||n("passwordPrompt"),b=v.weakLabel||n("weak"),S=v.mediumLabel||n("medium"),x=v.strongLabel||n("strong"),N=k(e.useState(!1),2),I=N[0],O=N[1],C=k(e.useState(null),2),P=C[0],A=C[1],j=k(e.useState(E),2),L=j[0],T=j[1],M=k(e.useState(!1),2),J=M[0],X=M[1],z=k(e.useState(!1),2),F=z[0],H=z[1],U=e.useRef(null),Z=e.useRef(null),B=e.useRef(v.inputRef),K=e.useRef(new RegExp(v.mediumRegex)),V=e.useRef(new RegExp(v.strongRegex)),_=F?"text":"password",D=k(o({target:U,overlay:Z,listener:function(e,t){t.valid&&ne()},when:I}),2),Y=D[0],$=D[1],q=B.current&&B.current.value,G=e.useMemo((function(){return s.isNotEmpty(v.value)||s.isNotEmpty(v.defaultValue)||s.isNotEmpty(q)}),[v.value,v.defaultValue,q]),Q=function(){if(P){var e=null;switch(P.strength){case"weak":e=b;break;case"medium":e=S;break;case"strong":e=x}e&&L!==e&&T(e)}else L!==E&&T(E)},W=function(e){v.feedback&&u.emit("overlay-click",{originalEvent:e,target:U.current})},ee=function(){H((function(e){return!e}))},te=function(){Q(),O(!0)},ne=function(){O(!1)},re=function(){c.set("overlay",Z.current,t.autoZIndex,t.zIndex.overlay),B.current&&p.alignOverlay(Z.current,B.current.parentElement,v.appendTo||t.appendTo)},oe=function(){Y(),v.onShow&&v.onShow()},le=function(){$()},ae=function(){c.clear(Z.current),v.onHide&&v.onHide()},ue=function(e){return V.current.test(e)?3:K.current.test(e)?2:e.length?1:0};e.useImperativeHandle(w,(function(){return{props:v,focus:function(){return p.focus(B.current)},getElement:function(){return U.current},getOverlay:function(){return Z.current},getInput:function(){return B.current}}})),e.useEffect((function(){s.combinedRefs(B,v.inputRef)}),[B,v.inputRef]),e.useEffect((function(){K.current=new RegExp(v.mediumRegex)}),[v.mediumRegex]),e.useEffect((function(){V.current=new RegExp(v.strongRegex)}),[v.strongRegex]),e.useEffect((function(){!G&&p.hasClass(U.current,"p-inputwrapper-filled")&&p.removeClass(U.current,"p-inputwrapper-filled")}),[G]),l((function(){c.clear(Z.current)}));var ie,se,pe,ce,fe,me,de,ge=f("p-password p-component p-inputwrapper",{"p-inputwrapper-filled":G,"p-inputwrapper-focus":J,"p-input-icon-right":v.toggleMask},v.className),ye=f("p-password-input",v.inputClassName),he=R.getOtherProps(v),we=function(){var t=m.getJSXIcon(F?v.hideIcon||e.createElement(g,null):v.showIcon||e.createElement(d,null),void 0,{props:v});if(v.toggleMask){var n=e.createElement("i",{onClick:ee}," ",t," ");if(v.icon)n=s.getJSXElement(v.icon,{onClick:ee,className:ge,element:n,props:v});return n}return null}(),ve=(ie=f("p-password-panel p-component",v.panelClassName,{"p-input-filled":"filled"===t.inputStyle,"p-ripple-disabled":!1===t.ripple}),pe=(se=P||{strength:"",width:"0%"}).strength,ce=se.width,fe=s.getJSXElement(v.header,v),me=s.getJSXElement(v.footer,v),de=v.content?s.getJSXElement(v.content,v):e.createElement(e.Fragment,null,e.createElement("div",{className:"p-password-meter"},e.createElement("div",{className:"p-password-strength ".concat(pe),style:{width:ce}})),e.createElement("div",{className:"p-password-info ".concat(pe)},L)),e.createElement(i,{element:e.createElement(r,{nodeRef:Z,classNames:"p-connected-overlay",in:I,timeout:{enter:120,exit:100},options:v.transitionOptions,unmountOnExit:!0,onEnter:re,onEntered:oe,onExit:le,onExited:ae},e.createElement("div",{ref:Z,className:ie,style:v.panelStyle,onClick:W},fe,de,me)),appendTo:v.appendTo}));return e.createElement("div",{ref:U,id:v.id,className:ge,style:v.style},e.createElement(a,y({ref:B,id:v.inputId},he,{type:_,className:ye,style:v.inputStyle,onFocus:function(e){X(!0),v.feedback&&te(),v.onFocus&&v.onFocus(e)},onBlur:function(e){X(!1),v.feedback&&ne(),v.onBlur&&v.onBlur(e)},onKeyUp:function(e){var t=e.keyCode||e.which;if(v.feedback){var n=null,r=null;switch(ue(e.target.value)){case 1:n=b,r={strength:"weak",width:"33.33%"};break;case 2:n=S,r={strength:"medium",width:"66.66%"};break;case 3:n=x,r={strength:"strong",width:"100%"};break;default:n=E,r=null}A(r),T(n),t&&!I&&te()}v.onKeyUp&&v.onKeyUp(e)},onInput:function(e,t){v.onInput&&v.onInput(e,t),v.onChange||(s.isNotEmpty(e.target.value)?p.addClass(U.current,"p-inputwrapper-filled"):p.removeClass(U.current,"p-inputwrapper-filled"))},tooltip:v.tooltip,tooltipOptions:v.tooltipOptions})),we,ve)})));S.displayName="Password";export{S as Password};
