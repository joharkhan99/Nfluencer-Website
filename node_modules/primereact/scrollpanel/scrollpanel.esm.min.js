import*as e from"react";import{useMountEffect as r,useUnmountEffect as t}from"primereact/hooks";import{mergeProps as n,classNames as l,DomHandler as c}from"primereact/utils";import{ComponentBase as o}from"primereact/componentbase";var u=o.extend({defaultProps:{__TYPE:"ScrollPanel",id:null,style:null,className:null,children:void 0}}),a=e.forwardRef((function(o,a){var s=u.getProps(o),i=u.setMetaData({props:s}).ptm,p=e.useRef(null),d=e.useRef(null),m=e.useRef(null),f=e.useRef(null),h=e.useRef(!1),g=e.useRef(!1),v=e.useRef(null),b=e.useRef(null),w=e.useRef(null),E=e.useRef(null),x=e.useRef(null),y=e.useRef(!1),C=function(){var e=d.current.scrollWidth,r=-1*(p.current.clientHeight-m.current.clientHeight);w.current=d.current.clientWidth/e;var t=d.current.scrollHeight,n=-1*(p.current.clientWidth-f.current.clientWidth);E.current=d.current.clientHeight/t,x.current=window.requestAnimationFrame((function(){w.current>=1?c.addClass(m.current,"p-scrollpanel-hidden"):(c.removeClass(m.current,"p-scrollpanel-hidden"),m.current.style.cssText="width:"+Math.max(100*w.current,10)+"%; left:"+d.current.scrollLeft/e*100+"%;bottom:"+r+"px;"),E.current>=1?c.addClass(f.current,"p-scrollpanel-hidden"):(c.removeClass(f.current,"p-scrollpanel-hidden"),f.current.style.cssText="height:"+Math.max(100*E.current,10)+"%; top: calc("+d.current.scrollTop/t*100+"% - "+m.current.clientHeight+"px);right:"+n+"px;")}))},R=function(e){h.current?L(e):(g.current||L(e),H(e))},L=function(e){var r=e.pageX-v.current;v.current=e.pageX,x.current=window.requestAnimationFrame((function(){d.current.scrollLeft+=r/w.current}))},H=function(e){var r=e.pageY-b.current;b.current=e.pageY,x.current=window.requestAnimationFrame((function(){d.current.scrollTop+=r/E.current}))},F=function e(r){c.removeClass(f.current,"p-scrollpanel-grabbed"),c.removeClass(m.current,"p-scrollpanel-grabbed"),c.removeClass(document.body,"p-scrollpanel-grabbed"),document.removeEventListener("mousemove",R),document.removeEventListener("mouseup",e),h.current=!1,g.current=!1},N=function(){C()};r((function(){var e,r,t;C(),window.addEventListener("resize",C),e=getComputedStyle(p.current),r=getComputedStyle(m.current),t=c.getHeight(p.current)-parseInt(r.height,10),"none"!==e["max-height"]&&0===t&&(p.current.style.height=d.current.offsetHeight+parseInt(r.height,10)>parseInt(e["max-height"],10)?e["max-height"]:d.current.offsetHeight+parseFloat(e.paddingTop)+parseFloat(e.paddingBottom)+parseFloat(e.borderTopWidth)+parseFloat(e.borderBottomWidth)+"px"),y.current=!0})),t((function(){y.current&&window.removeEventListener("resize",C),x.current&&window.cancelAnimationFrame(x.current)})),e.useImperativeHandle(a,(function(){return{props:s,refresh:N,getElement:function(){return p.current},getContent:function(){return d.current},getXBar:function(){return m.current},getYBar:function(){return f.current}}}));var T=n({id:s.id,ref:p,style:s.style,className:l("p-scrollpanel p-component",s.className)},u.getOtherProps(s),i("root")),M=n({className:"p-scrollpanel-wrapper"},i("wrapper")),P=n({className:"p-scrollpanel-content",ref:d,onScroll:C,onMouseEnter:C},i("content")),W=n({ref:m,className:"p-scrollpanel-bar p-scrollpanel-bar-x",onMouseDown:function(e){h.current=!0,v.current=e.pageX,c.addClass(m.current,"p-scrollpanel-grabbed"),c.addClass(document.body,"p-scrollpanel-grabbed"),document.addEventListener("mousemove",R),document.addEventListener("mouseup",F),e.preventDefault()}},i("barx")),D=n({ref:f,className:"p-scrollpanel-bar p-scrollpanel-bar-y",onMouseDown:function(e){g.current=!0,b.current=e.pageY,c.addClass(f.current,"p-scrollpanel-grabbed"),c.addClass(document.body,"p-scrollpanel-grabbed"),document.addEventListener("mousemove",R),document.addEventListener("mouseup",F),e.preventDefault()}},i("bary"));return e.createElement("div",T,e.createElement("div",M,e.createElement("div",P,s.children)),e.createElement("div",W),e.createElement("div",D))}));a.displayName="ScrollPanel";export{a as ScrollPanel};
